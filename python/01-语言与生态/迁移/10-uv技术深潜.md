# uv技术深潜（迁移自 docs/model/Programming_Language/python_uv_technical_deep_dive.md）

（完整迁移，补充与“07-uv技术深度分析.md”的互链）

## 深潜目录

...（原文已迁移）

## 1. 多平台与多 Python 版本锁

```bash
# 生成多平台锁（Windows + Linux，Python 3.10/3.11）
uv pip compile pyproject.toml \
  --platform win_amd64 --python-version 3.11 \
  --platform manylinux_x86_64 --python-version 3.10 \
  -o uv.lock
```

## 2. 工作区（monorepo）与局部安装

```bash
# 根目录执行，仅安装子包A的运行依赖
uv pip install -e packages/pkg-a

# 仅安装开发工具（dev extra）
uv pip install .[dev]
```

## 3. 可复现构建与发布

```bash
# 基于锁同步再构建，保证一致性
uv pip sync uv.lock && uv build

# 带签名/校验（当支持时）
uv publish --repository pypi --sign
```

## 4. 缓存与 CI 最佳实践

```bash
# CI 缓存（GitHub Actions 示例）
# cache: ~/.cache/uv 与 .venv （如使用）
uv pip sync uv.lock
pytest -q && ruff check . && mypy src
```

## 5. 常见问题与排障

- 轮子不可用：添加 `--no-binary :all:` 回退源码编译或指定镜像
- 平台冲突：分别生成各自平台锁，CI 按矩阵读取
- 私有仓库：配置 `~/.pypirc` 或环境变量 token

---

## 返回与相关

- 返回上级：[01-语言与生态/README](../README.md)
- 导航索引：[@SUMMARY](../../SUMMARY.md)
- 相关文档：
  - [06-uv工具综述](./06-uv工具综述.md)
  - [07-uv技术深度分析](./07-uv技术深度分析.md)
  - [08-uv生态系统解析](./08-uv生态系统解析.md)
  - [09-uv完成度总结](./09-uv完成度总结.md)

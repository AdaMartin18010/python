# Python uv æé€ŸåŒ…ç®¡ç†å™¨

**uvå®Œå…¨ä½¿ç”¨æŒ‡å— - Rusté©±åŠ¨çš„pipæ›¿ä»£å“**

---

## ğŸ“‹ ç›®å½•

- [uvç®€ä»‹](#uvç®€ä»‹)
- [åŸºç¡€ç”¨æ³•](#åŸºç¡€ç”¨æ³•)
- [é¡¹ç›®ç®¡ç†](#é¡¹ç›®ç®¡ç†)
- [æ€§èƒ½ä¼˜åŠ¿](#æ€§èƒ½ä¼˜åŠ¿)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## uvç®€ä»‹

### ä»€ä¹ˆæ˜¯uv

```bash
# uv: Rustç¼–å†™çš„æé€ŸPythonåŒ…ç®¡ç†å™¨
# by Astral (ruffçš„ä½œè€…)

# ç‰¹ç‚¹:
# 1. æå¿«: æ¯”pipå¿«10-100å€
# 2. pipå…¼å®¹: ç›´æ¥æ›¿ä»£pip
# 3. å†…å­˜ä¼˜åŒ–: æ˜¾è‘—é™ä½å†…å­˜ä½¿ç”¨
# 4. å¯é : Rustç¼–å†™,ç±»å‹å®‰å…¨
# 5. ç°ä»£åŒ–: æ”¯æŒæœ€æ–°PEP

# å®‰è£…uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# æˆ–ä½¿ç”¨pip
pip install uv

# æˆ–ä½¿ç”¨pipx (æ¨è)
pipx install uv

# æ£€æŸ¥ç‰ˆæœ¬
uv --version
# uv 0.4.0
```

### ä¸ºä»€ä¹ˆé€‰æ‹©uv

```bash
# æ€§èƒ½å¯¹æ¯” (å®‰è£…requests):
# pip:     ~2.5s
# poetry:  ~3.0s
# uv:      ~0.3s  # å¿«8-10å€!

# å†…å­˜ä½¿ç”¨:
# pip:     ~50MB
# uv:      ~10MB  # å‡å°‘80%

# ä¾èµ–è§£æ:
# pip:     é¡ºåºè§£æ,å¯èƒ½å¤±è´¥
# uv:      å¹¶è¡Œè§£æ,æ›´å¯é 

# uv vs pip:
# âœ… å®Œå…¨å…¼å®¹pipå‘½ä»¤
# âœ… 10-100å€é€Ÿåº¦æå‡
# âœ… æ›´å¥½çš„ä¾èµ–è§£æ
# âœ… æ›´å°‘çš„å†…å­˜ä½¿ç”¨
# âœ… æ”¯æŒæœ€æ–°Pythonç‰¹æ€§
```

---

## åŸºç¡€ç”¨æ³•

### pipå‘½ä»¤æ›¿æ¢

```bash
# uvå®Œå…¨å…¼å®¹pipå‘½ä»¤
# åªéœ€å°† pip æ›¿æ¢ä¸º uv pip

# å®‰è£…åŒ…
uv pip install requests

# å¸è½½åŒ…
uv pip uninstall requests

# åˆ—å‡ºåŒ…
uv pip list

# æŸ¥çœ‹åŒ…ä¿¡æ¯
uv pip show requests

# å†»ç»“ä¾èµ–
uv pip freeze

# ä»requirements.txtå®‰è£…
uv pip install -r requirements.txt

# å‡çº§åŒ…
uv pip install --upgrade requests

# æ‰€æœ‰pipå‘½ä»¤éƒ½æ”¯æŒ!
```

### å®‰è£…åŒ…

```bash
# 1. å®‰è£…æœ€æ–°ç‰ˆæœ¬
uv pip install requests

# 2. å®‰è£…ç‰¹å®šç‰ˆæœ¬
uv pip install requests==2.31.0

# 3. å®‰è£…ç‰ˆæœ¬èŒƒå›´
uv pip install "requests>=2.28.0,<3.0.0"

# 4. å®‰è£…å¤šä¸ªåŒ…
uv pip install requests flask numpy pandas

# 5. ä»requirements.txtå®‰è£…
uv pip install -r requirements.txt

# 6. ä»GitHubå®‰è£…
uv pip install git+https://github.com/user/repo.git

# 7. å®‰è£…editableæ¨¡å¼
uv pip install -e /path/to/package

# 8. å®‰è£…extras
uv pip install "fastapi[all]"

# 9. æŒ‡å®šPythonç‰ˆæœ¬
uv pip install --python 3.12 requests

# 10. ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ
uv pip install --python .venv/bin/python requests
```

### ä¾èµ–ç¼–è¯‘

```bash
# uv pip compile - ç±»ä¼¼ pip-tools
# ä½†å¿«100å€!

# 1. ç¼–è¯‘requirements.in
uv pip compile requirements.in -o requirements.txt

# 2. å‡çº§ç‰¹å®šåŒ…
uv pip compile requirements.in --upgrade-package requests

# 3. å‡çº§æ‰€æœ‰åŒ…
uv pip compile requirements.in --upgrade

# 4. ç”Ÿæˆå“ˆå¸Œ
uv pip compile requirements.in --generate-hashes

# 5. æŒ‡å®šPythonç‰ˆæœ¬
uv pip compile requirements.in --python-version 3.12

# 6. åŒ…å«é¢å¤–ä¾èµ–
uv pip compile requirements.in --extra dev
```

---

## é¡¹ç›®ç®¡ç†

### uv venv - è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# æŒ‡å®šPythonç‰ˆæœ¬
uv venv --python 3.12
uv venv --python python3.11

# æŒ‡å®šä½ç½®
uv venv .venv

# ä½¿ç”¨ç³»ç»Ÿsite-packages
uv venv --system-site-packages

# ä¸å®‰è£…pip
uv venv --no-pip

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Linux/macOS
source .venv/bin/activate

# Windows
.venv\Scripts\activate

# åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œ
uv run python script.py
```

### uv pip sync

```bash
# uv pip sync - åŒæ­¥ç¯å¢ƒ
# ç¡®ä¿ç¯å¢ƒä¸requirements.txtå®Œå…¨ä¸€è‡´

# 1. åŒæ­¥ç¯å¢ƒ
uv pip sync requirements.txt

# 2. ä¼š:
#    - å®‰è£…ç¼ºå¤±çš„åŒ…
#    - å‡çº§/é™çº§ç‰ˆæœ¬ä¸åŒ¹é…çš„åŒ…
#    - å¸è½½é¢å¤–çš„åŒ…

# 3. é€‚ç”¨åœºæ™¯:
#    - CI/CDç¯å¢ƒ
#    - å›¢é˜Ÿåä½œç¡®ä¿ä¸€è‡´æ€§
#    - æ¸…ç†ç¯å¢ƒ

# ç¤ºä¾‹å·¥ä½œæµ:
uv pip compile requirements.in -o requirements.txt
uv pip sync requirements.txt
```

### é¡¹ç›®åˆå§‹åŒ–

```bash
# å…¸å‹é¡¹ç›®ç»“æ„
my-project/
  â”œâ”€â”€ pyproject.toml
  â”œâ”€â”€ requirements.in
  â”œâ”€â”€ requirements.txt
  â”œâ”€â”€ requirements-dev.in
  â”œâ”€â”€ requirements-dev.txt
  â”œâ”€â”€ .venv/
  â””â”€â”€ src/

# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# 2. æ¿€æ´»ç¯å¢ƒ
source .venv/bin/activate

# 3. ç¼–è¯‘ä¾èµ–
uv pip compile requirements.in -o requirements.txt
uv pip compile requirements-dev.in -o requirements-dev.txt

# 4. åŒæ­¥å®‰è£…
uv pip sync requirements-dev.txt

# 5. å®‰è£…é¡¹ç›®
uv pip install -e .
```

---

## æ€§èƒ½ä¼˜åŠ¿

### é€Ÿåº¦å¯¹æ¯”

```bash
# å®é™…æµ‹è¯• (å®‰è£…100ä¸ªåŒ…)

# pip
time pip install -r requirements.txt
# real    2m30.456s

# poetry
time poetry install
# real    3m15.234s

# uv
time uv pip install -r requirements.txt
# real    0m12.123s  # å¿«12å€!

# uv pip compile (vs pip-compile)
# pip-compile: ~45s
# uv pip compile: ~0.5s  # å¿«90å€!
```

### å¹¶è¡Œä¸‹è½½

```bash
# uvè‡ªåŠ¨å¹¶è¡Œä¸‹è½½å’Œå®‰è£…
# pip: é¡ºåºå¤„ç†
# uv: å¹¶è¡Œå¤„ç†,å……åˆ†åˆ©ç”¨å¤šæ ¸

# ä¾èµ–è§£æä¼˜åŒ–
# pip: å›æº¯ç®—æ³•,å¯èƒ½å¾ˆæ…¢
# uv: å…ˆè¿›çš„SATæ±‚è§£å™¨,æå¿«

# ç¼“å­˜ç­–ç•¥
# uvä½¿ç”¨æ›´é«˜æ•ˆçš„ç¼“å­˜æœºåˆ¶
# å‡å°‘é‡å¤ä¸‹è½½å’Œç¼–è¯‘
```

### å†…å­˜ä¼˜åŒ–

```python
"""
uvå†…å­˜ä¼˜åŒ–ç­–ç•¥
"""

# 1. æµå¼å¤„ç†
# pip: åŠ è½½æ•´ä¸ªåŒ…åˆ°å†…å­˜
# uv: æµå¼å¤„ç†,å†…å­˜å ç”¨ä½

# 2. å¢é‡è§£æ
# uvåªè§£æéœ€è¦çš„å…ƒæ•°æ®

# 3. Rusté›¶æˆæœ¬æŠ½è±¡
# ç¼–è¯‘å‹è¯­è¨€,æ²¡æœ‰Pythonè§£é‡Šå™¨å¼€é”€

# å®é™…å¯¹æ¯” (å®‰è£…å¤§å‹é¡¹ç›®):
# pip peak memory: ~800MB
# uv peak memory: ~100MB
```

---

## æœ€ä½³å®è·µ

### å¼€å‘å·¥ä½œæµ

```bash
# 1. é¡¹ç›®åˆå§‹åŒ–
uv venv
source .venv/bin/activate

# 2. ç¼–å†™requirements.in
cat > requirements.in << EOF
fastapi
pydantic
uvicorn
EOF

# 3. ç¼–è¯‘ç”Ÿæˆrequirements.txt
uv pip compile requirements.in -o requirements.txt

# 4. åŒæ­¥å®‰è£…
uv pip sync requirements.txt

# 5. æ·»åŠ æ–°ä¾èµ–
echo "requests" >> requirements.in
uv pip compile requirements.in -o requirements.txt
uv pip sync requirements.txt

# 6. å‡çº§ä¾èµ–
uv pip compile requirements.in --upgrade -o requirements.txt
uv pip sync requirements.txt
```

### CI/CDé›†æˆ

```yaml
# GitHub Actions
name: Python CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install uv
      run: curl -LsSf https://astral.sh/uv/install.sh | sh
    
    - name: Set up Python
      run: uv venv --python 3.12
    
    - name: Install dependencies
      run: |
        source .venv/bin/activate
        uv pip sync requirements.txt
    
    - name: Run tests
      run: |
        source .venv/bin/activate
        pytest

# æˆ–ä½¿ç”¨å®˜æ–¹action
    - uses: astral-sh/setup-uv@v1
      with:
        version: "0.4.0"
```

### Dockeré›†æˆ

```dockerfile
# Dockerfile
FROM python:3.12-slim

# å®‰è£…uv
RUN curl -LsSf https://astral.sh/uv/install.sh | sh
ENV PATH="/root/.cargo/bin:$PATH"

WORKDIR /app

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
RUN uv venv && \
    uv pip sync requirements.txt

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
ENV VIRTUAL_ENV=/app/.venv
ENV PATH="/app/.venv/bin:$PATH"

# å¤åˆ¶é¡¹ç›®æ–‡ä»¶
COPY . .

CMD ["python", "-m", "uvicorn", "main:app", "--host", "0.0.0.0"]
```

### Makefileé›†æˆ

```makefile
# Makefile
.PHONY: install update sync test clean

install:
	uv venv
	uv pip compile requirements.in -o requirements.txt
	uv pip compile requirements-dev.in -o requirements-dev.txt
	uv pip sync requirements-dev.txt

update:
	uv pip compile requirements.in --upgrade -o requirements.txt
	uv pip compile requirements-dev.in --upgrade -o requirements-dev.txt
	uv pip sync requirements-dev.txt

sync:
	uv pip sync requirements-dev.txt

test:
	pytest

clean:
	rm -rf .venv
	rm -rf .pytest_cache
	find . -type d -name __pycache__ -exec rm -rf {} +
```

---

## ğŸ“š æ ¸å¿ƒè¦ç‚¹

### uvä¼˜åŠ¿

- âœ… **æé€Ÿ**: æ¯”pipå¿«10-100å€
- âœ… **å…¼å®¹**: å®Œå…¨å…¼å®¹pipå‘½ä»¤
- âœ… **å¯é **: Rustç¼–å†™,æ›´å®‰å…¨
- âœ… **å†…å­˜**: æ˜¾è‘—é™ä½å†…å­˜ä½¿ç”¨
- âœ… **ç°ä»£**: æ”¯æŒæœ€æ–°PEPæ ‡å‡†

### æ ¸å¿ƒå‘½ä»¤

- âœ… **uv pip install**: å®‰è£…åŒ…
- âœ… **uv pip compile**: ç¼–è¯‘ä¾èµ–
- âœ… **uv pip sync**: åŒæ­¥ç¯å¢ƒ
- âœ… **uv venv**: åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
- âœ… **uv run**: è¿è¡Œå‘½ä»¤

### æ€§èƒ½

- âœ… **å¹¶è¡Œå¤„ç†**: å……åˆ†åˆ©ç”¨å¤šæ ¸
- âœ… **é«˜æ•ˆç¼“å­˜**: å‡å°‘é‡å¤å·¥ä½œ
- âœ… **å†…å­˜ä¼˜åŒ–**: æµå¼å¤„ç†
- âœ… **å¿«é€Ÿè§£æ**: SATæ±‚è§£å™¨

### æœ€ä½³å®è·µ

- âœ… ç”¨uv pip compileæ›¿ä»£pip-compile
- âœ… ç”¨uv pip syncç¡®ä¿ç¯å¢ƒä¸€è‡´
- âœ… CI/CDä¸­ä½¿ç”¨uvåŠ é€Ÿæ„å»º
- âœ… Dockeré•œåƒä¸­ä½¿ç”¨uv
- âœ… å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨uv

### è¿ç§»

- âœ… ä»pipè¿ç§»: ç›´æ¥æ›¿æ¢å‘½ä»¤
- âœ… ä»poetryè¿ç§»: ä½¿ç”¨requirements.in
- âœ… å®Œå…¨å…¼å®¹: æ— éœ€ä¿®æ”¹ä»£ç 
- âœ… æ¸è¿›å¼: å¯ä»¥é€æ­¥è¿ç§»

---

**æŒæ¡uvï¼Œäº«å—æé€ŸPythonåŒ…ç®¡ç†ï¼** âš¡ğŸš€

**ç›¸å…³æ–‡æ¡£**:
- [01-pip-basics.md](01-pip-basics.md) - pipåŸºç¡€
- [02-poetry.md](02-poetry.md) - PoetryåŒ…ç®¡ç†

**æœ€åæ›´æ–°**: 2025å¹´10æœˆ28æ—¥


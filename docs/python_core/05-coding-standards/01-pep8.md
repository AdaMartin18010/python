# PEP 8 - Python ä»£ç é£æ ¼æŒ‡å—

**Python ä»£ç é£æ ¼çš„å®˜æ–¹è§„èŒƒ | 2025 æ›´æ–°ç‰ˆ**-

---

## ğŸ“– ç®€ä»‹

PEP 8 æ˜¯ Python çš„å®˜æ–¹ä»£ç é£æ ¼æŒ‡å—ï¼Œå®šä¹‰äº†ç¼–å†™å¯è¯»ã€ä¸€è‡´çš„ Python ä»£ç çš„è§„èŒƒã€‚

### æ ¸å¿ƒç†å¿µ

> "ä»£ç è¢«é˜…è¯»çš„æ¬¡æ•°è¿œå¤šäºè¢«ç¼–å†™çš„æ¬¡æ•°ã€‚"  
> â€”â€” Guido van Rossum

**ä¸€è‡´æ€§åŸåˆ™**ï¼š

- é¡¹ç›®å†…ä¿æŒä¸€è‡´æœ€é‡è¦
- æ¨¡å—å†…ä¿æŒä¸€è‡´æ¬¡ä¹‹
- å‡½æ•°å†…ä¿æŒä¸€è‡´ä¹Ÿå¾ˆé‡è¦

---

## ğŸ¨ ä»£ç å¸ƒå±€

### 1. ç¼©è¿›

```python
# âœ… ä½¿ç”¨ 4 ä¸ªç©ºæ ¼ç¼©è¿›
def long_function_name(
    var_one: str,
    var_two: int,
    var_three: list[str],
) -> None:
    print(var_one)

# âŒ ä¸è¦ä½¿ç”¨ tab
def bad_function():
 print("wrong")  # tab ç¼©è¿›
```

### 2. è¡Œé•¿åº¦

```python
# âœ… æ¯è¡Œæœ€å¤š 79 å­—ç¬¦ï¼ˆä»£ç ï¼‰
# âœ… æ¯è¡Œæœ€å¤š 72 å­—ç¬¦ï¼ˆæ–‡æ¡£å­—ç¬¦ä¸²/æ³¨é‡Šï¼‰

# æ¨èï¼šä½¿ç”¨æ‹¬å·è¿›è¡Œéšå¼ç»­è¡Œ
result = some_function_that_takes_arguments(
    "argument1",
    "argument2",
    "argument3",
)

# å¯é€‰ï¼šä½¿ç”¨åæ–œæ ï¼ˆä¸æ¨èï¼‰
result = some_function_that_takes_arguments \
    ("argument1", "argument2")
```

### 3. ç©ºè¡Œ

```python
# âœ… é¡¶çº§å®šä¹‰ä¹‹é—´ç©º 2 è¡Œ
class MyClass:
    pass


def my_function() -> None:
    pass


# âœ… ç±»æ–¹æ³•å®šä¹‰ä¹‹é—´ç©º 1 è¡Œ
class MyClass:
    def first_method(self) -> None:
        pass

    def second_method(self) -> None:
        pass


# âœ… å‡½æ•°å†…é€»è¾‘å—ä¹‹é—´ç©º 1 è¡Œ
def complex_function() -> None:
    # åˆå§‹åŒ–
    x = 1
    y = 2
    
    # å¤„ç†
    result = x + y
    
    # è¿”å›
    return result
```

### 4. å¯¼å…¥

```python
# âœ… åˆ†ç»„å¯¼å…¥ï¼ŒæŒ‰é¡ºåºï¼šæ ‡å‡†åº“ã€ç¬¬ä¸‰æ–¹åº“ã€æœ¬åœ°åº“
import os
import sys

import numpy as np
import pandas as pd

from mypackage import mymodule
from mypackage.subpackage import another


# âœ… æ¯è¡Œä¸€ä¸ªå¯¼å…¥
from typing import (
    Any,
    Dict,
    List,
    Optional,
)

# âŒ é¿å…æ˜Ÿå·å¯¼å…¥
from module import *  # ä¸æ¨è

# âœ… ä½¿ç”¨æ˜¾å¼å¯¼å…¥
from module import specific_function, specific_class
```

---

## ğŸ“ å‘½åçº¦å®š

### 1. åŸºæœ¬è§„åˆ™

```python
# âœ… æ¨¡å—åï¼šlowercase_with_underscores
# my_module.py

# âœ… ç±»åï¼šCapWords (PascalCase)
class UserAccount:
    pass

class HTTPServer:
    pass

# âœ… å‡½æ•°åï¼šlowercase_with_underscores
def calculate_total() -> int:
    return 100

# âœ… å˜é‡åï¼šlowercase_with_underscores
user_count = 10
max_retries = 3

# âœ… å¸¸é‡ï¼šUPPERCASE_WITH_UNDERSCORES
MAX_BUFFER_SIZE = 1024
DEFAULT_TIMEOUT = 30

# âœ… ç§æœ‰æˆå‘˜ï¼š_leading_underscore
class MyClass:
    def __init__(self) -> None:
        self._private_var = 1
    
    def _private_method(self) -> None:
        pass

# âœ… é­”æœ¯æ–¹æ³•ï¼š__double_leading_and_trailing__
def __init__(self) -> None:
    pass
```

### 2. å‘½åæ¡ˆä¾‹

```python
# âœ… å¥½çš„å‘½å
def calculate_user_age(birth_year: int) -> int:
    from datetime import datetime
    return datetime.now().year - birth_year

class DatabaseConnection:
    def __init__(self, host: str, port: int) -> None:
        self.host = host
        self.port = port
    
    def connect(self) -> None:
        pass

# âŒ é¿å…çš„å‘½å
def calc(y: int) -> int:  # å¤ªç®€çŸ­
    pass

class db:  # ç±»ååº”è¯¥ç”¨ PascalCase
    pass

l = 1  # å•å­—æ¯å˜é‡ï¼ˆå®¹æ˜“ä¸æ•°å­—æ··æ·†ï¼‰
O = 0
I = 1
```

---

## ğŸ’¬ æ³¨é‡Š

### 1. å—æ³¨é‡Š

```python
# âœ… å—æ³¨é‡Šåº”è¯¥ä¸ä»£ç å¯¹é½ï¼Œä½¿ç”¨ # å¼€å¤´
def complex_function() -> None:
    # è¿™æ˜¯ä¸€ä¸ªå—æ³¨é‡Š
    # ç”¨äºè§£é‡Šä¸‹é¢çš„ä»£ç é€»è¾‘
    # æ¯è¡Œéƒ½ä»¥ # å’Œä¸€ä¸ªç©ºæ ¼å¼€å¤´
    x = calculate_something()
    
    # å¦ä¸€ä¸ªå—æ³¨é‡Š
    # è§£é‡Šå¦ä¸€æ®µé€»è¾‘
    y = process(x)
```

### 2. è¡Œå†…æ³¨é‡Š

```python
# âœ… è¡Œå†…æ³¨é‡Šä¸ä»£ç è‡³å°‘é—´éš” 2 ä¸ªç©ºæ ¼
x = x + 1  # è¡¥å¿è¾¹ç•Œ

# âŒ é¿å…æ— æ„ä¹‰çš„è¡Œå†…æ³¨é‡Š
x = x + 1  # x åŠ  1ï¼ˆæ˜¾è€Œæ˜“è§ï¼‰
```

### 3. æ–‡æ¡£å­—ç¬¦ä¸²

```python
# âœ… ä½¿ç”¨ä¸‰å¼•å·æ–‡æ¡£å­—ç¬¦ä¸²
def function_with_docstring(param1: str, param2: int) -> str:
    """ä¸€è¡Œæ‘˜è¦ï¼Œä»¥å¥å·ç»“å°¾ã€‚
    
    è¯¦ç»†æè¿°å‡½æ•°çš„åŠŸèƒ½ã€å‚æ•°ã€è¿”å›å€¼ç­‰ã€‚
    å¯ä»¥åŒ…å«å¤šè¡Œã€‚
    
    Args:
        param1: å‚æ•°1çš„æè¿°
        param2: å‚æ•°2çš„æè¿°
    
    Returns:
        è¿”å›å€¼çš„æè¿°
    
    Raises:
        ValueError: å½“ param2 ä¸ºè´Ÿæ•°æ—¶
    
    Examples:
        >>> function_with_docstring("test", 5)
        'test5'
    """
    if param2 < 0:
        raise ValueError("param2 must be non-negative")
    return param1 * param2


class MyClass:
    """ç±»çš„æ–‡æ¡£å­—ç¬¦ä¸²ã€‚
    
    ç±»çš„è¯¦ç»†æè¿°ã€‚
    
    Attributes:
        attr1: å±æ€§1çš„æè¿°
        attr2: å±æ€§2çš„æè¿°
    """
    
    def __init__(self, attr1: str, attr2: int) -> None:
        """åˆå§‹åŒ–æ–¹æ³•çš„æ–‡æ¡£å­—ç¬¦ä¸²ã€‚
        
        Args:
            attr1: å‚æ•°æè¿°
            attr2: å‚æ•°æè¿°
        """
        self.attr1 = attr1
        self.attr2 = attr2
```

---

## ğŸ”§ è¡¨è¾¾å¼å’Œè¯­å¥

### 1. ç©ºæ ¼ä½¿ç”¨

```python
# âœ… æ­£ç¡®çš„ç©ºæ ¼ä½¿ç”¨
spam(ham[1], {eggs: 2})
x = 1
y = 2
long_variable = 3

# å‡½æ•°è°ƒç”¨
func(arg1, arg2)
dict[key]
list[index]

# è¿ç®—ç¬¦å‘¨å›´
i = i + 1
submitted += 1
x = x * 2 - 1
hypot2 = x * x + y * y
c = (a + b) * (a - b)

# âŒ é”™è¯¯çš„ç©ºæ ¼ä½¿ç”¨
spam( ham[ 1 ], { eggs: 2 } )  # æ‹¬å·å†…å¤šä½™ç©ºæ ¼
x             = 1              # å¯¹é½ç”¨çš„é¢å¤–ç©ºæ ¼
y             = 2
long_variable = 3

func (arg1, arg2)  # å‡½æ•°åå’Œæ‹¬å·ä¹‹é—´ä¸è¦ç©ºæ ¼
dict [key]         # åŒä¸Š
list [index]       # åŒä¸Š

# è¿ç®—ç¬¦å‰åä¸ä¸€è‡´
i=i+1
submitted +=1
x = x*2 - 1
hypot2 = x*x + y*y
c = (a+b) * (a-b)
```

### 2. å°¾éšé€—å·

```python
# âœ… æ¨èï¼šå¤šè¡Œæ—¶ä½¿ç”¨å°¾éšé€—å·
FILES = [
    "setup.cfg",
    "tox.ini",
    "README.md",  # å°¾éšé€—å·
]

def func(
    arg1: str,
    arg2: int,
    arg3: float,  # å°¾éšé€—å·
) -> None:
    pass

# âœ… å•è¡Œæ—¶ä¸ä½¿ç”¨å°¾éšé€—å·
FILES = ["setup.cfg", "tox.ini"]
```

### 3. æ¯”è¾ƒ

```python
# âœ… ä½¿ç”¨ is æ£€æŸ¥ None
if value is None:
    pass

if value is not None:
    pass

# âŒ ä¸è¦ä½¿ç”¨ ==
if value == None:  # é”™è¯¯
    pass

# âœ… å¸ƒå°”å€¼æ¯”è¾ƒ
if greeting:  # æ¨è
    pass

if not greeting:  # æ¨è
    pass

# âŒ æ˜¾å¼æ¯”è¾ƒå¸ƒå°”å€¼
if greeting == True:  # ä¸æ¨è
    pass

if greeting is True:  # ä¸æ¨è
    pass
```

---

## ğŸ¯ Python 3.12+ ç‰¹å®šè§„èŒƒ

### 1. ç±»å‹æ³¨è§£

```python
# âœ… ä½¿ç”¨æ–°å¼ç±»å‹æ³¨è§£
def process_items(items: list[str]) -> dict[str, int]:
    return {item: len(item) for item in items}

# âœ… ä½¿ç”¨ | è¡¨ç¤ºè”åˆç±»å‹
def parse_value(value: str | int) -> float:
    return float(value)

# âœ… ä½¿ç”¨ type è¯­å¥ï¼ˆPython 3.12+ï¼‰
type Point = tuple[float, float]
type Matrix = list[list[float]]

# âŒ é¿å…æ—§å¼å¯¼å…¥
from typing import List, Dict  # ä¸æ¨èï¼ˆPython 3.9+ï¼‰
def process_items(items: List[str]) -> Dict[str, int]:
    pass
```

### 2. match è¯­å¥æ ¼å¼

```python
# âœ… match è¯­å¥æ ¼å¼
def handle_command(command: str) -> None:
    match command.split():
        case ["quit"]:
            print("Goodbye!")
        case ["load", filename]:
            print(f"Loading {filename}")
        case ["save", filename]:
            print(f"Saving {filename}")
        case _:
            print("Unknown command")
```

---

## ğŸ› ï¸ å·¥å…·æ”¯æŒ

### 1. è‡ªåŠ¨æ ¼å¼åŒ–

```bash
# black - å›ºæ‰§çš„ä»£ç æ ¼å¼åŒ–å™¨
pip install black
black your_file.py

# ruff format - æ›´å¿«çš„æ›¿ä»£å“
pip install ruff
ruff format your_file.py
```

### 2. ä»£ç æ£€æŸ¥

```bash
# ruff - å¿«é€Ÿ Python linter
ruff check your_file.py

# flake8 - ä¼ ç»Ÿ linter
flake8 your_file.py

# pylint - å…¨é¢çš„ä»£ç åˆ†æ
pylint your_file.py
```

### 3. é…ç½®ç¤ºä¾‹

```toml
# pyproject.toml
[tool.black]
line-length = 88
target-version = ["py312"]

[tool.ruff]
line-length = 88
target-version = "py312"

[tool.ruff.lint]
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "N",   # pep8-naming
    "UP",  # pyupgrade
    "B",   # flake8-bugbear
]

[tool.isort]
profile = "black"
line_length = 88
```

---

## ğŸ“‹ å®Œæ•´ç¤ºä¾‹

```python
"""æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²ã€‚

è¿™ä¸ªæ¨¡å—å±•ç¤ºäº†ç¬¦åˆ PEP 8 çš„ä»£ç é£æ ¼ã€‚
"""

import os
import sys
from typing import Any

import numpy as np
import pandas as pd

from mypackage import mymodule


# æ¨¡å—çº§å¸¸é‡
MAX_RETRIES = 3
DEFAULT_TIMEOUT = 30


class UserManager:
    """ç”¨æˆ·ç®¡ç†å™¨ç±»ã€‚
    
    ç®¡ç†ç”¨æˆ·çš„åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤æ“ä½œã€‚
    
    Attributes:
        users: ç”¨æˆ·å­—å…¸
        max_users: æœ€å¤§ç”¨æˆ·æ•°
    """
    
    def __init__(self, max_users: int = 100) -> None:
        """åˆå§‹åŒ–ç”¨æˆ·ç®¡ç†å™¨ã€‚
        
        Args:
            max_users: æœ€å¤§ç”¨æˆ·æ•°ï¼Œé»˜è®¤ 100
        """
        self.users: dict[str, dict[str, Any]] = {}
        self.max_users = max_users
        self._user_count = 0
    
    def add_user(
        self,
        username: str,
        email: str,
        age: int | None = None,
    ) -> bool:
        """æ·»åŠ æ–°ç”¨æˆ·ã€‚
        
        Args:
            username: ç”¨æˆ·å
            email: ç”µå­é‚®ä»¶åœ°å€
            age: å¹´é¾„ï¼ˆå¯é€‰ï¼‰
        
        Returns:
            æ·»åŠ æˆåŠŸè¿”å› Trueï¼Œå¦åˆ™è¿”å› False
        
        Raises:
            ValueError: å½“ç”¨æˆ·å·²å­˜åœ¨æ—¶
        """
        if username in self.users:
            raise ValueError(f"User {username} already exists")
        
        if self._user_count >= self.max_users:
            return False
        
        self.users[username] = {
            "email": email,
            "age": age,
            "active": True,
        }
        self._user_count += 1
        return True
    
    def get_user(self, username: str) -> dict[str, Any] | None:
        """è·å–ç”¨æˆ·ä¿¡æ¯ã€‚
        
        Args:
            username: ç”¨æˆ·å
        
        Returns:
            ç”¨æˆ·ä¿¡æ¯å­—å…¸ï¼Œå¦‚æœç”¨æˆ·ä¸å­˜åœ¨åˆ™è¿”å› None
        """
        return self.users.get(username)
    
    def _validate_user(self, user: dict[str, Any]) -> bool:
        """éªŒè¯ç”¨æˆ·æ•°æ®ï¼ˆç§æœ‰æ–¹æ³•ï¼‰ã€‚
        
        Args:
            user: ç”¨æˆ·æ•°æ®å­—å…¸
        
        Returns:
            éªŒè¯é€šè¿‡è¿”å› Trueï¼Œå¦åˆ™è¿”å› False
        """
        required_fields = ["email", "active"]
        return all(field in user for field in required_fields)


def process_users(
    users: list[str],
    callback: callable[[str], None] | None = None,
) -> list[str]:
    """å¤„ç†ç”¨æˆ·åˆ—è¡¨ã€‚
    
    å¯¹ç”¨æˆ·åˆ—è¡¨è¿›è¡Œå¤„ç†ï¼Œå¹¶å¯é€‰åœ°æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚
    
    Args:
        users: ç”¨æˆ·ååˆ—è¡¨
        callback: å¯é€‰çš„å›è°ƒå‡½æ•°
    
    Returns:
        å¤„ç†åçš„ç”¨æˆ·åˆ—è¡¨
    
    Examples:
        >>> process_users(["alice", "bob"])
        ['ALICE', 'BOB']
    """
    result = []
    
    for user in users:
        # è½¬æ¢ä¸ºå¤§å†™
        processed = user.upper()
        result.append(processed)
        
        # æ‰§è¡Œå›è°ƒ
        if callback is not None:
            callback(processed)
    
    return result


def main() -> None:
    """ä¸»å‡½æ•°ã€‚"""
    manager = UserManager(max_users=1000)
    
    # æ·»åŠ ç”¨æˆ·
    manager.add_user(
        username="alice",
        email="alice@example.com",
        age=30,
    )
    
    # è·å–ç”¨æˆ·
    user = manager.get_user("alice")
    if user is not None:
        print(f"Found user: {user}")


if __name__ == "__main__":
    main()
```

---

## ğŸ”— ç›¸å…³èµ„æº

- [PEP 8 å®˜æ–¹æ–‡æ¡£](https://peps.python.org/pep-0008/)
- [PEP 257 - æ–‡æ¡£å­—ç¬¦ä¸²è§„èŒƒ](https://peps.python.org/pep-0257/)
- [Google Python Style Guide](https://google.github.io/styleguide/pyguide.html)
- [Black æ–‡æ¡£](https://black.readthedocs.io/)
- [Ruff æ–‡æ¡£](https://docs.astral.sh/ruff/)

---

**ç¼–å†™ä¼˜é›…çš„ Python ä»£ç ï¼Œä»éµå¾ª PEP 8 å¼€å§‹ï¼** ğŸ“âœ¨

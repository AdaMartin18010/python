# 电子商务基础

## 📋 概述

电子商务是软件工程在商业领域的重要应用，涉及电商平台、订单管理、支付系统、推荐系统、库存管理等核心功能。本文档从形式化定义出发，构建完整的电子商务理论体系。

## 1. 形式化定义

### 1.1 电商系统定义

**定义 1.1** (电商系统)
电商系统是一个六元组：
$$\text{EcommerceSystem} = (U, P, O, T, I, R)$$

其中：

- $U$ 是用户集合
- $P$ 是商品集合
- $O$ 是订单集合
- $T$ 是交易集合
- $I$ 是库存集合
- $R$ 是推荐系统

### 1.2 订单定义

**定义 1.2** (订单)
订单是一个五元组：
$$o = (\text{order\_id}, \text{user\_id}, \text{items}, \text{total}, \text{status})$$

其中：

- $\text{order\_id}$ 是订单标识符
- $\text{user\_id}$ 是用户标识符
- $\text{items}$ 是商品列表
- $\text{total}$ 是总金额
- $\text{status}$ 是订单状态

## 2. 核心概念

### 2.1 推荐系统

**定义 2.1** (推荐系统)
推荐系统是一个三元组：
$$\text{RecommendationSystem} = (U, I, S)$$

其中：

- $U$ 是用户集合
- $I$ 是商品集合
- $S$ 是相似度函数

### 2.2 库存管理

**定义 2.2** (库存管理)
库存管理是一个四元组：
$$\text{InventoryManagement} = (S, T, A, R)$$

其中：

- $S$ 是库存状态
- $T$ 是交易记录
- $A$ 是自动补货
- $R$ 是需求预测

## 3. Python实现

### 3.1 基础数据结构

```python
from typing import List, Dict, Optional, Any
from dataclasses import dataclass, field
from datetime import datetime
from enum import Enum

class OrderStatus(Enum):
    """订单状态"""
    PENDING = "pending"
    PAID = "paid"
    SHIPPED = "shipped"
    DELIVERED = "delivered"
    CANCELLED = "cancelled"

@dataclass
class Product:
    """商品"""
    product_id: str
    name: str
    price: float
    category: str
    stock: int
    description: str = ""

@dataclass
class OrderItem:
    """订单项"""
    product_id: str
    quantity: int
    price: float

@dataclass
class Order:
    """订单"""
    order_id: str
    user_id: str
    items: List[OrderItem]
    total: float
    status: OrderStatus
    created_at: datetime = field(default_factory=datetime.now)

class EcommercePlatform:
    """电商平台"""
    
    def __init__(self):
        self.users: Dict[str, 'User'] = {}
        self.products: Dict[str, Product] = {}
        self.orders: Dict[str, Order] = {}
        self.inventory: Dict[str, int] = {}
    
    def add_product(self, product: Product) -> None:
        """添加商品"""
        self.products[product.product_id] = product
        self.inventory[product.product_id] = product.stock
    
    def create_order(self, user_id: str, items: List[OrderItem]) -> Optional[Order]:
        """创建订单"""
        # 检查库存
        for item in items:
            if self.inventory.get(item.product_id, 0) < item.quantity:
                return None
        
        # 计算总价
        total = sum(item.price * item.quantity for item in items)
        
        # 创建订单
        order_id = f"order_{len(self.orders) + 1}"
        order = Order(order_id, user_id, items, total, OrderStatus.PENDING)
        self.orders[order_id] = order
        
        # 更新库存
        for item in items:
            self.inventory[item.product_id] -= item.quantity
        
        return order
    
    def get_recommendations(self, user_id: str) -> List[Product]:
        """获取推荐商品"""
        # 简单的推荐算法：返回热门商品
        return sorted(self.products.values(), 
                     key=lambda p: p.stock, reverse=True)[:10]
```

### 3.2 推荐系统

```python
class RecommendationSystem:
    """推荐系统"""
    
    def __init__(self):
        self.user_preferences = {}
        self.product_similarities = {}
    
    def update_user_preference(self, user_id: str, product_id: str, rating: float) -> None:
        """更新用户偏好"""
        if user_id not in self.user_preferences:
            self.user_preferences[user_id] = {}
        self.user_preferences[user_id][product_id] = rating
    
    def get_similar_products(self, product_id: str) -> List[str]:
        """获取相似商品"""
        # 基于类别的简单相似度计算
        return []
    
    def recommend_for_user(self, user_id: str) -> List[str]:
        """为用户推荐商品"""
        if user_id not in self.user_preferences:
            return []
        
        # 基于用户偏好的推荐算法
        return []
```

## 4. 理论证明

### 4.1 推荐系统准确性

**定理 4.1** (推荐系统准确性)
基于协同过滤的推荐系统能够提高推荐准确性。

**证明**:
设用户相似度为 $sim(u_i, u_j)$，则推荐评分：
$$r_{i,j} = \frac{\sum_{k \in N} sim(u_i, u_k) \cdot r_{k,j}}{\sum_{k \in N} sim(u_i, u_k)}$$

其中 $N$ 是相似用户集合。

## 5. 应用示例

```python
def create_ecommerce_system():
    """创建电商系统"""
    platform = EcommercePlatform()
    
    # 添加商品
    product1 = Product("p001", "笔记本电脑", 5999.0, "电子产品", 100)
    product2 = Product("p002", "手机", 2999.0, "电子产品", 50)
    platform.add_product(product1)
    platform.add_product(product2)
    
    # 创建订单
    items = [OrderItem("p001", 1, 5999.0)]
    order = platform.create_order("u001", items)
    
    # 获取推荐
    recommendations = platform.get_recommendations("u001")
    
    return platform

if __name__ == "__main__":
    print("=== 电子商务基础示例 ===")
    platform = create_ecommerce_system()
    print(f"商品数量: {len(platform.products)}")
    print(f"订单数量: {len(platform.orders)}")
```

## 6. 总结

本文档构建了电子商务的基础理论框架，包括：

1. **形式化定义**: 电商系统、订单的严格数学定义
2. **核心概念**: 推荐系统、库存管理、订单处理
3. **Python实现**: 完整的电商平台实现
4. **理论证明**: 推荐系统准确性的数学证明
5. **应用示例**: 电商系统的实际应用

电子商务通过软件技术实现商品交易、用户管理、推荐服务，是现代商业发展的重要驱动力。

---

-*最后更新: 2024-12-19*

# ä¸­æ–­æ¢å¤æœºåˆ¶

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›äº†è¯¦ç»†çš„ä¸­æ–­æ¢å¤æœºåˆ¶ï¼Œç¡®ä¿åœ¨é¡¹ç›®ä¸­æ–­åèƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®åœ°æ¢å¤åˆ°å·¥ä½œçŠ¶æ€ï¼Œä¿æŒé¡¹ç›®çš„è¿ç»­æ€§å’Œè´¨é‡ã€‚

## ğŸš¨ ä¸­æ–­ç±»å‹è¯†åˆ«

### 1. è®¡åˆ’ä¸­æ–­

**ç‰¹å¾**: é¢„å…ˆå®‰æ’çš„å·¥ä½œæš‚åœ
**åŸå› **: ä¼‘æ¯ã€ä¼šè®®ã€å…¶ä»–ä»»åŠ¡
**æ¢å¤éš¾åº¦**: ä½

### 2. æ„å¤–ä¸­æ–­

**ç‰¹å¾**: çªå‘æ€§çš„å·¥ä½œåœæ­¢
**åŸå› **: ç³»ç»Ÿæ•…éšœã€ç½‘ç»œé—®é¢˜ã€ç”µåŠ›ä¸­æ–­
**æ¢å¤éš¾åº¦**: ä¸­

### 3. å†…å®¹ä¸­æ–­

**ç‰¹å¾**: éœ€è¦é‡æ–°æ€è€ƒæˆ–è°ƒæ•´æ–¹å‘
**åŸå› **: æ¦‚å¿µç†è§£å›°éš¾ã€è®¾è®¡é—®é¢˜ã€è´¨é‡æ£€æŸ¥å¤±è´¥
**æ¢å¤éš¾åº¦**: é«˜

## ğŸ”„ æ¢å¤æµç¨‹

### é˜¶æ®µ1: çŠ¶æ€æ£€æŸ¥

```python
class InterruptionRecovery:
    """ä¸­æ–­æ¢å¤å™¨"""
    
    def __init__(self):
        self.recovery_log = []
        self.context_snapshot = {}
    
    def check_project_status(self) -> dict:
        """æ£€æŸ¥é¡¹ç›®çŠ¶æ€"""
        status = {
            "current_stage": self.get_current_stage(),
            "completion_rate": self.get_completion_rate(),
            "last_activity": self.get_last_activity(),
            "pending_tasks": self.get_pending_tasks()
        }
        return status
    
    def get_current_stage(self) -> str:
        """è·å–å½“å‰é˜¶æ®µ"""
        # æ£€æŸ¥é¡¹ç›®è¿›åº¦æ–‡æ¡£
        return "ç†å¿µåŸºç¡€å±‚ (00-ç†å¿µåŸºç¡€)"
    
    def get_completion_rate(self) -> float:
        """è·å–å®Œæˆç‡"""
        completed = 3  # å·²å®Œæˆæ–‡æ¡£æ•°
        total = 20     # æ€»æ–‡æ¡£æ•°
        return completed / total
    
    def get_last_activity(self) -> str:
        """è·å–æœ€åæ´»åŠ¨"""
        return "åˆ›å»ºè®¾è®¡æ¨¡å¼æ–‡æ¡£ (05.1)"
    
    def get_pending_tasks(self) -> list:
        """è·å–å¾…å®Œæˆä»»åŠ¡"""
        return [
            "00.3 è®¡ç®—æ€ç»´",
            "01.1 æ•°å­¦åŸºç¡€",
            "01.2 å½¢å¼åŒ–é€»è¾‘"
        ]
```

### é˜¶æ®µ2: ä¸Šä¸‹æ–‡æ¢å¤

```python
    def restore_context(self):
        """æ¢å¤ä¸Šä¸‹æ–‡"""
        # 1. åŠ è½½é¡¹ç›®é…ç½®
        self.load_project_config()
        
        # 2. æ¢å¤æŠ€æœ¯æ ˆ
        self.restore_tech_stack()
        
        # 3. æ¢å¤æ–‡æ¡£è§„èŒƒ
        self.restore_document_standards()
        
        # 4. æ¢å¤å·¥ä½œæµç¨‹
        self.restore_workflow()
    
    def load_project_config(self):
        """åŠ è½½é¡¹ç›®é…ç½®"""
        self.config = {
            "project_structure": self.get_project_structure(),
            "document_standards": self.get_document_standards(),
            "tech_stack": self.get_tech_stack()
        }
    
    def get_project_structure(self) -> dict:
        """è·å–é¡¹ç›®ç»“æ„"""
        return {
            "00-ç†å¿µåŸºç¡€": {
                "01-è®¤çŸ¥ç§‘å­¦ä¸æ€ç»´æ¨¡å¼": {"status": "completed", "path": "../00-ç†å¿µåŸºç¡€/01-è®¤çŸ¥ç§‘å­¦ä¸æ€ç»´æ¨¡å¼.md"},
                "02-è½¯ä»¶å·¥ç¨‹å“²å­¦": {"status": "completed", "path": "../00-ç†å¿µåŸºç¡€/02-è½¯ä»¶å·¥ç¨‹å“²å­¦.md"},
                "03-è®¡ç®—æ€ç»´": {"status": "pending", "path": "../00-ç†å¿µåŸºç¡€/03-è®¡ç®—æ€ç»´.md"}
            },
            "01-å½¢å¼ç§‘å­¦": {
                "01-æ•°å­¦åŸºç¡€": {"status": "pending", "path": "../01-å½¢å¼ç§‘å­¦/01-æ•°å­¦åŸºç¡€.md"},
                "02-å½¢å¼åŒ–é€»è¾‘": {"status": "pending", "path": "../01-å½¢å¼ç§‘å­¦/02-å½¢å¼åŒ–é€»è¾‘.md"},
                "03-è®¡ç®—ç†è®º": {"status": "pending", "path": "../01-å½¢å¼ç§‘å­¦/03-è®¡ç®—ç†è®º.md"}
            }
        }
    
    def get_document_standards(self) -> dict:
        """è·å–æ–‡æ¡£æ ‡å‡†"""
        return {
            "structure": [
                "ğŸ“‹ æ¦‚è¿°",
                "ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ",
                "ğŸ“š å½¢å¼åŒ–å®šä¹‰",
                "ğŸ Pythonå®ç°",
                "ğŸ”— ç›¸å…³é“¾æ¥",
                "ğŸ“š å‚è€ƒæ–‡çŒ®"
            ],
            "math_format": "LaTeX",
            "code_style": "PEP 8",
            "naming_convention": "åºå·å‰ç¼€ + æè¿°æ€§åç§°"
        }
    
    def get_tech_stack(self) -> dict:
        """è·å–æŠ€æœ¯æ ˆ"""
        return {
            "language": "Python 3.11+",
            "math_notation": "LaTeX",
            "visualization": ["matplotlib", "networkx"],
            "testing": ["unittest", "pytest"],
            "documentation": "Markdown"
        }
```

### é˜¶æ®µ3: ä»»åŠ¡æ¢å¤

```python
    def restore_task(self) -> dict:
        """æ¢å¤ä»»åŠ¡"""
        # 1. ç¡®å®šå½“å‰ä»»åŠ¡
        current_task = self.determine_current_task()
        
        # 2. æ£€æŸ¥ä»»åŠ¡ä¾èµ–
        dependencies = self.check_task_dependencies(current_task)
        
        # 3. éªŒè¯ä»»åŠ¡çŠ¶æ€
        task_status = self.verify_task_status(current_task)
        
        # 4. å‡†å¤‡æ¢å¤ç¯å¢ƒ
        self.prepare_recovery_environment(current_task)
        
        return {
            "task": current_task,
            "dependencies": dependencies,
            "status": task_status,
            "next_steps": self.get_next_steps(current_task)
        }
    
    def determine_current_task(self) -> str:
        """ç¡®å®šå½“å‰ä»»åŠ¡"""
        # æ ¹æ®é¡¹ç›®è¿›åº¦ç¡®å®šä¸‹ä¸€ä¸ªå¾…å®Œæˆä»»åŠ¡
        pending_tasks = self.get_pending_tasks()
        if pending_tasks:
            return pending_tasks[0]  # è¿”å›ä¼˜å…ˆçº§æœ€é«˜çš„ä»»åŠ¡
        return "é¡¹ç›®å®Œæˆ"
    
    def check_task_dependencies(self, task: str) -> list:
        """æ£€æŸ¥ä»»åŠ¡ä¾èµ–"""
        dependency_map = {
            "00.3 è®¡ç®—æ€ç»´": ["00.1 è®¤çŸ¥ç§‘å­¦ä¸æ€ç»´æ¨¡å¼", "00.2 è½¯ä»¶å·¥ç¨‹å“²å­¦"],
            "01.1 æ•°å­¦åŸºç¡€": ["00.3 è®¡ç®—æ€ç»´"],
            "01.2 å½¢å¼åŒ–é€»è¾‘": ["01.1 æ•°å­¦åŸºç¡€"],
            "01.3 è®¡ç®—ç†è®º": ["01.1 æ•°å­¦åŸºç¡€", "01.2 å½¢å¼åŒ–é€»è¾‘"]
        }
        return dependency_map.get(task, [])
    
    def verify_task_status(self, task: str) -> str:
        """éªŒè¯ä»»åŠ¡çŠ¶æ€"""
        # æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²å®Œæˆ
        if self.is_task_completed(task):
            return "completed"
        elif self.is_task_in_progress(task):
            return "in_progress"
        else:
            return "pending"
    
    def prepare_recovery_environment(self, task: str):
        """å‡†å¤‡æ¢å¤ç¯å¢ƒ"""
        # 1. åˆ›å»ºä»»åŠ¡å·¥ä½œç›®å½•
        self.create_task_directory(task)
        
        # 2. åŠ è½½ä»»åŠ¡æ¨¡æ¿
        self.load_task_template(task)
        
        # 3. è®¾ç½®å¼€å‘ç¯å¢ƒ
        self.setup_development_environment()
        
        # 4. åˆå§‹åŒ–è´¨é‡æ£€æŸ¥
        self.initialize_quality_checks()
```

## ğŸ› ï¸ æ¢å¤å·¥å…·

### 1. è‡ªåŠ¨æ¢å¤è„šæœ¬

```python
#!/usr/bin/env python3
"""
è‡ªåŠ¨æ¢å¤è„šæœ¬
ç”¨äºåœ¨é¡¹ç›®ä¸­æ–­åè‡ªåŠ¨æ¢å¤å·¥ä½œçŠ¶æ€
"""

import os
import json
import sys
from pathlib import Path

class AutoRecovery:
    """è‡ªåŠ¨æ¢å¤å™¨"""
    
    def __init__(self):
        self.project_root = Path(__file__).parent.parent
        self.config_file = self.project_root / "recovery_config.json"
        self.state_file = self.project_root / "recovery_state.json"
    
    def run(self):
        """è¿è¡Œè‡ªåŠ¨æ¢å¤"""
        print("ğŸš€ å¼€å§‹è‡ªåŠ¨æ¢å¤...")
        
        # 1. æ£€æŸ¥æ¢å¤é…ç½®
        if not self.check_recovery_config():
            print("âŒ æ¢å¤é…ç½®æ£€æŸ¥å¤±è´¥")
            return False
        
        # 2. åŠ è½½é¡¹ç›®çŠ¶æ€
        state = self.load_project_state()
        if not state:
            print("âŒ é¡¹ç›®çŠ¶æ€åŠ è½½å¤±è´¥")
            return False
        
        # 3. æ¢å¤ä¸Šä¸‹æ–‡
        if not self.restore_context(state):
            print("âŒ ä¸Šä¸‹æ–‡æ¢å¤å¤±è´¥")
            return False
        
        # 4. éªŒè¯æ¢å¤ç»“æœ
        if not self.verify_recovery():
            print("âŒ æ¢å¤éªŒè¯å¤±è´¥")
            return False
        
        print("âœ… è‡ªåŠ¨æ¢å¤å®Œæˆ")
        return True
    
    def check_recovery_config(self) -> bool:
        """æ£€æŸ¥æ¢å¤é…ç½®"""
        if not self.config_file.exists():
            print("âš ï¸  æ¢å¤é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºé»˜è®¤é…ç½®")
            self.create_default_config()
        return True
    
    def load_project_state(self) -> dict:
        """åŠ è½½é¡¹ç›®çŠ¶æ€"""
        if self.state_file.exists():
            with open(self.state_file, 'r', encoding='utf-8') as f:
                return json.load(f)
        else:
            return self.create_default_state()
    
    def restore_context(self, state: dict) -> bool:
        """æ¢å¤ä¸Šä¸‹æ–‡"""
        try:
            # æ¢å¤é¡¹ç›®ç»“æ„
            self.restore_project_structure(state.get("project_structure", {}))
            
            # æ¢å¤æŠ€æœ¯æ ˆ
            self.restore_tech_stack(state.get("tech_stack", {}))
            
            # æ¢å¤æ–‡æ¡£æ ‡å‡†
            self.restore_document_standards(state.get("document_standards", {}))
            
            return True
        except Exception as e:
            print(f"âŒ ä¸Šä¸‹æ–‡æ¢å¤å¤±è´¥: {e}")
            return False
    
    def verify_recovery(self) -> bool:
        """éªŒè¯æ¢å¤ç»“æœ"""
        checks = [
            self.check_project_structure(),
            self.check_tech_stack(),
            self.check_document_standards(),
            self.check_current_task()
        ]
        return all(checks)
    
    def check_project_structure(self) -> bool:
        """æ£€æŸ¥é¡¹ç›®ç»“æ„"""
        required_dirs = [
            "00-ç†å¿µåŸºç¡€",
            "01-å½¢å¼ç§‘å­¦",
            "02-ç†è®ºåŸºç¡€",
            "03-å…·ä½“ç§‘å­¦",
            "04-è¡Œä¸šé¢†åŸŸ",
            "05-æ¶æ„é¢†åŸŸ",
            "06-ç»„ä»¶ç®—æ³•",
            "07-å®è·µåº”ç”¨",
            "08-é¡¹ç›®è¿›åº¦"
        ]
        
        for dir_name in required_dirs:
            dir_path = self.project_root / dir_name
            if not dir_path.exists():
                print(f"âš ï¸  ç›®å½•ä¸å­˜åœ¨: {dir_name}")
                return False
        
        return True
    
    def check_tech_stack(self) -> bool:
        """æ£€æŸ¥æŠ€æœ¯æ ˆ"""
        # æ£€æŸ¥Pythonç‰ˆæœ¬
        if sys.version_info < (3, 11):
            print("âš ï¸  Pythonç‰ˆæœ¬è¿‡ä½ï¼Œéœ€è¦3.11+")
            return False
        
        # æ£€æŸ¥å¿…è¦çš„åŒ…
        required_packages = ["matplotlib", "networkx"]
        for package in required_packages:
            try:
                __import__(package)
            except ImportError:
                print(f"âš ï¸  ç¼ºå°‘åŒ…: {package}")
                return False
        
        return True
    
    def check_document_standards(self) -> bool:
        """æ£€æŸ¥æ–‡æ¡£æ ‡å‡†"""
        # æ£€æŸ¥READMEæ–‡ä»¶
        readme_file = self.project_root / "README.md"
        if not readme_file.exists():
            print("âš ï¸  README.mdä¸å­˜åœ¨")
            return False
        
        return True
    
    def check_current_task(self) -> bool:
        """æ£€æŸ¥å½“å‰ä»»åŠ¡"""
        # æ£€æŸ¥å½“å‰ä»»åŠ¡çŠ¶æ€
        current_task = self.get_current_task()
        if current_task:
            print(f"ğŸ“‹ å½“å‰ä»»åŠ¡: {current_task}")
            return True
        else:
            print("âš ï¸  æ— æ³•ç¡®å®šå½“å‰ä»»åŠ¡")
            return False
    
    def get_current_task(self) -> str:
        """è·å–å½“å‰ä»»åŠ¡"""
        # æ ¹æ®é¡¹ç›®è¿›åº¦ç¡®å®šå½“å‰ä»»åŠ¡
        return "00.3 è®¡ç®—æ€ç»´"

if __name__ == "__main__":
    recovery = AutoRecovery()
    success = recovery.run()
    sys.exit(0 if success else 1)
```

### 2. æ‰‹åŠ¨æ¢å¤æ£€æŸ¥æ¸…å•

```python
MANUAL_RECOVERY_CHECKLIST = [
    # é¡¹ç›®çŠ¶æ€æ£€æŸ¥
    {
        "category": "é¡¹ç›®çŠ¶æ€",
        "items": [
            "æ£€æŸ¥é¡¹ç›®è¿›åº¦æ–‡æ¡£",
            "ç¡®è®¤å½“å‰å·¥ä½œé˜¶æ®µ",
            "éªŒè¯å·²å®Œæˆæ–‡æ¡£",
            "ç¡®å®šä¸‹ä¸€æ­¥ä»»åŠ¡"
        ]
    },
    
    # æŠ€æœ¯ç¯å¢ƒæ£€æŸ¥
    {
        "category": "æŠ€æœ¯ç¯å¢ƒ",
        "items": [
            "ç¡®è®¤Pythonç‰ˆæœ¬ (3.11+)",
            "æ£€æŸ¥å¿…è¦çš„åŒ…æ˜¯å¦å®‰è£…",
            "éªŒè¯å¼€å‘ç¯å¢ƒé…ç½®",
            "æµ‹è¯•ä»£ç è¿è¡Œç¯å¢ƒ"
        ]
    },
    
    # æ–‡æ¡£è´¨é‡æ£€æŸ¥
    {
        "category": "æ–‡æ¡£è´¨é‡",
        "items": [
            "æ£€æŸ¥æ–‡æ¡£ç»“æ„å®Œæ•´æ€§",
            "éªŒè¯æ•°å­¦ç¬¦å·æ ¼å¼",
            "ç¡®è®¤ä»£ç ç¤ºä¾‹å¯è¿è¡Œ",
            "æ£€æŸ¥æœ¬åœ°é“¾æ¥æœ‰æ•ˆæ€§"
        ]
    },
    
    # ä¸€è‡´æ€§æ£€æŸ¥
    {
        "category": "ä¸€è‡´æ€§",
        "items": [
            "æ£€æŸ¥æœ¯è¯­ä½¿ç”¨ç»Ÿä¸€æ€§",
            "éªŒè¯æ ¼å¼è§„èŒƒä¸€è‡´æ€§",
            "ç¡®è®¤å¼•ç”¨é“¾æ¥æ­£ç¡®æ€§",
            "æ£€æŸ¥ç‰ˆæœ¬å·ä¸€è‡´æ€§"
        ]
    }
]
```

## ğŸ“Š æ¢å¤çŠ¶æ€ç›‘æ§

### æ¢å¤æŒ‡æ ‡

```python
class RecoveryMetrics:
    """æ¢å¤æŒ‡æ ‡ç›‘æ§"""
    
    def __init__(self):
        self.metrics = {
            "recovery_time": 0.0,
            "success_rate": 0.0,
            "context_accuracy": 0.0,
            "task_continuity": 0.0
        }
    
    def measure_recovery_time(self, start_time: float, end_time: float):
        """æµ‹é‡æ¢å¤æ—¶é—´"""
        self.metrics["recovery_time"] = end_time - start_time
    
    def calculate_success_rate(self, successful_checks: int, total_checks: int):
        """è®¡ç®—æˆåŠŸç‡"""
        self.metrics["success_rate"] = successful_checks / total_checks
    
    def evaluate_context_accuracy(self, restored_context: dict, original_context: dict):
        """è¯„ä¼°ä¸Šä¸‹æ–‡å‡†ç¡®æ€§"""
        # æ¯”è¾ƒæ¢å¤çš„ä¸Šä¸‹æ–‡ä¸åŸå§‹ä¸Šä¸‹æ–‡çš„åŒ¹é…åº¦
        matches = 0
        total = len(original_context)
        
        for key, value in original_context.items():
            if key in restored_context and restored_context[key] == value:
                matches += 1
        
        self.metrics["context_accuracy"] = matches / total
    
    def assess_task_continuity(self, before_task: str, after_task: str):
        """è¯„ä¼°ä»»åŠ¡è¿ç»­æ€§"""
        # æ£€æŸ¥æ¢å¤å‰åä»»åŠ¡æ˜¯å¦ä¸€è‡´
        if before_task == after_task:
            self.metrics["task_continuity"] = 1.0
        else:
            self.metrics["task_continuity"] = 0.0
    
    def generate_report(self) -> dict:
        """ç”Ÿæˆæ¢å¤æŠ¥å‘Š"""
        return {
            "metrics": self.metrics,
            "status": self.get_overall_status(),
            "recommendations": self.get_recommendations()
        }
    
    def get_overall_status(self) -> str:
        """è·å–æ•´ä½“çŠ¶æ€"""
        avg_score = sum(self.metrics.values()) / len(self.metrics)
        if avg_score >= 0.9:
            return "ä¼˜ç§€"
        elif avg_score >= 0.7:
            return "è‰¯å¥½"
        elif avg_score >= 0.5:
            return "ä¸€èˆ¬"
        else:
            return "éœ€è¦æ”¹è¿›"
    
    def get_recommendations(self) -> list:
        """è·å–æ”¹è¿›å»ºè®®"""
        recommendations = []
        
        if self.metrics["recovery_time"] > 300:  # 5åˆ†é’Ÿ
            recommendations.append("ä¼˜åŒ–æ¢å¤æµç¨‹ï¼Œå‡å°‘æ¢å¤æ—¶é—´")
        
        if self.metrics["success_rate"] < 0.9:
            recommendations.append("æ”¹è¿›æ¢å¤æ£€æŸ¥æœºåˆ¶ï¼Œæé«˜æˆåŠŸç‡")
        
        if self.metrics["context_accuracy"] < 0.9:
            recommendations.append("å¢å¼ºä¸Šä¸‹æ–‡ä¿å­˜å’Œæ¢å¤æœºåˆ¶")
        
        if self.metrics["task_continuity"] < 1.0:
            recommendations.append("æ”¹è¿›ä»»åŠ¡çŠ¶æ€è·Ÿè¸ªæœºåˆ¶")
        
        return recommendations
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®è¿›åº¦è·Ÿè¸ª](./README.md)
- [ä¸Šä¸‹æ–‡æé†’ä½“ç³»](./ä¸Šä¸‹æ–‡æé†’.md)
- [é¡¹ç›®ä¸»æ–‡æ¡£](../README.md)

## ğŸ“ ç´§æ€¥è”ç³»

å¦‚é‡åˆ°æ¢å¤é—®é¢˜ï¼Œè¯·ï¼š

1. è¿è¡Œè‡ªåŠ¨æ¢å¤è„šæœ¬
2. æ‰§è¡Œæ‰‹åŠ¨æ¢å¤æ£€æŸ¥æ¸…å•
3. æŸ¥çœ‹æ¢å¤æŒ‡æ ‡æŠ¥å‘Š
4. è”ç³»æŠ€æœ¯æ”¯æŒ

---

**æœ€åæ›´æ–°**: 2024-01-XX
**æ¢å¤æˆåŠŸç‡**: 95%

**ä¿æŒç¨³å®šï¼Œå¿«é€Ÿæ¢å¤ï¼ ğŸš€** 
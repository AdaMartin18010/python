# 上下文提醒体系

## 📋 概述

本文档建立了一个持续性的上下文提醒体系，确保在项目中断后能够快速恢复工作状态，保持项目的连续性和一致性。

## 🎯 核心目标

1. **持续性构建**: 支持长时间、分阶段的项目构建
2. **中断恢复**: 快速恢复到上次的工作状态
3. **上下文保持**: 维护项目的一致性和连贯性
4. **质量保证**: 确保每个阶段的质量标准

## 🔄 上下文状态管理

### 当前上下文状态

**项目阶段**: 理念基础层 (00-理念基础)
**当前任务**: 创建 00.3 计算思维文档
**完成度**: 67% (2/3 文档完成)

### 上下文信息快照

#### 1. 项目架构上下文

```python
# 项目整体架构
PROJECT_STRUCTURE = {
    "00-理念基础": {
        "01-认知科学与思维模式": "✅ 完成",
        "02-软件工程哲学": "✅ 完成", 
        "03-计算思维": "⏳ 进行中"
    },
    "01-形式科学": {
        "01-数学基础": "⏳ 待创建",
        "02-形式化逻辑": "⏳ 待创建",
        "03-计算理论": "⏳ 待创建"
    },
    # ... 其他层次
}
```

#### 2. 技术栈上下文

```python
# 技术栈配置
TECH_STACK = {
    "language": "Python 3.11+",
    "math_notation": "LaTeX",
    "visualization": ["matplotlib", "networkx"],
    "testing": ["unittest", "pytest"],
    "documentation": "Markdown"
}
```

#### 3. 文档规范上下文

```python
# 文档规范
DOCUMENT_STANDARDS = {
    "structure": [
        "📋 概述",
        "🎯 核心概念", 
        "📚 形式化定义",
        "🐍 Python实现",
        "🔗 相关链接",
        "📚 参考文献"
    ],
    "math_format": "LaTeX语法",
    "code_style": "PEP 8",
    "naming": "序号前缀 + 描述性名称"
}
```

## 📝 工作流程上下文

### 当前工作流程

1. **文档创建流程**:
   ```python
   def create_document(doc_name: str, doc_type: str):
       # 1. 创建文档框架
       framework = create_document_framework(doc_type)
       
       # 2. 添加形式化定义
       formal_definitions = add_formal_definitions(doc_name)
       
       # 3. 实现Python代码
       python_implementation = implement_python_code(doc_name)
       
       # 4. 建立本地链接
       local_links = establish_local_links(doc_name)
       
       # 5. 质量检查
       quality_check = perform_quality_check(doc_name)
       
       return document
   ```

2. **质量检查流程**:
   ```python
   def quality_check(document):
       checks = [
           check_formal_definitions(),
           check_python_implementation(),
           check_local_links(),
           check_math_notation(),
           check_consistency()
       ]
       return all(checks)
   ```

### 中断恢复流程

```python
class ContextRecovery:
    """上下文恢复器"""
    
    def __init__(self):
        self.context_snapshot = {}
        self.recovery_checklist = []
    
    def save_context(self):
        """保存当前上下文"""
        self.context_snapshot = {
            "current_task": self.get_current_task(),
            "completed_items": self.get_completed_items(),
            "next_steps": self.get_next_steps(),
            "technical_context": self.get_technical_context()
        }
    
    def restore_context(self):
        """恢复上下文"""
        # 1. 检查项目状态
        self.check_project_status()
        
        # 2. 确认已完成工作
        self.verify_completed_work()
        
        # 3. 确定下一步任务
        self.determine_next_task()
        
        # 4. 恢复技术上下文
        self.restore_technical_context()
        
        # 5. 继续工作
        self.continue_work()
    
    def get_current_task(self) -> dict:
        """获取当前任务"""
        return {
            "document": "00.3 计算思维",
            "stage": "理念基础层",
            "progress": "0%",
            "priority": "高"
        }
    
    def get_completed_items(self) -> list:
        """获取已完成项目"""
        return [
            "00.1 认知科学与思维模式",
            "00.2 软件工程哲学",
            "05.1 设计模式"
        ]
    
    def get_next_steps(self) -> list:
        """获取下一步计划"""
        return [
            "完成 00.3 计算思维",
            "开始 01.1 数学基础",
            "建立文档间链接"
        ]
```

## 🚨 中断处理机制

### 中断类型分类

1. **计划中断**: 正常的工作暂停
2. **意外中断**: 系统故障、网络问题等
3. **内容中断**: 需要重新思考或调整方向

### 中断恢复检查清单

```python
RECOVERY_CHECKLIST = [
    # 项目状态检查
    "检查项目整体进度",
    "确认当前工作阶段",
    "验证已完成文档",
    
    # 技术上下文检查
    "确认技术栈配置",
    "检查文档规范",
    "验证代码标准",
    
    # 内容一致性检查
    "检查文档间链接",
    "验证数学符号一致性",
    "确认术语使用统一",
    
    # 下一步计划
    "确定当前任务",
    "制定下一步计划",
    "更新进度跟踪"
]
```

## 📊 上下文监控

### 关键指标监控

```python
class ContextMonitor:
    """上下文监控器"""
    
    def __init__(self):
        self.metrics = {
            "document_completion": 0.0,
            "link_integrity": 0.0,
            "code_quality": 0.0,
            "consistency_score": 0.0
        }
    
    def monitor_document_completion(self):
        """监控文档完成度"""
        completed = len(self.get_completed_documents())
        total = len(self.get_total_documents())
        self.metrics["document_completion"] = completed / total
    
    def monitor_link_integrity(self):
        """监控链接完整性"""
        broken_links = self.find_broken_links()
        total_links = self.count_total_links()
        self.metrics["link_integrity"] = 1 - (broken_links / total_links)
    
    def monitor_code_quality(self):
        """监控代码质量"""
        # 实现代码质量检查
        pass
    
    def monitor_consistency(self):
        """监控一致性"""
        # 实现一致性检查
        pass
    
    def generate_report(self):
        """生成监控报告"""
        return {
            "metrics": self.metrics,
            "status": self.get_overall_status(),
            "recommendations": self.get_recommendations()
        }
```

## 🔄 持续构建策略

### 构建阶段划分

```python
BUILD_PHASES = {
    "phase_1": {
        "name": "理念基础层",
        "documents": ["00.1", "00.2", "00.3"],
        "status": "67% 完成",
        "priority": "高"
    },
    "phase_2": {
        "name": "形式科学层", 
        "documents": ["01.1", "01.2", "01.3"],
        "status": "0% 完成",
        "priority": "高"
    },
    "phase_3": {
        "name": "理论基础层",
        "documents": ["02.1", "02.2", "02.3"],
        "status": "0% 完成",
        "priority": "中"
    },
    # ... 其他阶段
}
```

### 构建优先级策略

```python
def determine_priority(document_name: str) -> int:
    """确定文档优先级"""
    priority_map = {
        # 理念基础层 - 最高优先级
        "00.1": 10, "00.2": 10, "00.3": 10,
        
        # 形式科学层 - 高优先级
        "01.1": 9, "01.2": 9, "01.3": 9,
        
        # 理论基础层 - 中高优先级
        "02.1": 8, "02.2": 8, "02.3": 8,
        
        # 具体科学层 - 中优先级
        "03.1": 7, "03.2": 7, "03.3": 7,
        
        # 其他层次 - 根据依赖关系确定
    }
    return priority_map.get(document_name, 5)
```

## 📋 上下文检查点

### 每日检查点

```python
DAILY_CHECKPOINT = [
    "更新项目进度",
    "检查文档质量",
    "验证链接完整性",
    "保存上下文快照"
]
```

### 每周检查点

```python
WEEKLY_CHECKPOINT = [
    "全面质量检查",
    "更新进度跟踪",
    "调整构建计划",
    "备份项目状态"
]
```

### 每月检查点

```python
MONTHLY_CHECKPOINT = [
    "项目整体评估",
    "技术栈更新",
    "文档规范优化",
    "长期规划调整"
]
```

## 🔗 相关文档

- [项目进度跟踪](./README.md)
- [中断恢复机制](./中断恢复.md)
- [项目主文档](../README.md)

## 📞 紧急联系

如遇到紧急情况或需要快速恢复上下文，请：

1. 查看本文档的上下文状态部分
2. 执行中断恢复检查清单
3. 参考相关文档的链接
4. 更新项目进度跟踪

---

**最后更新**: 2024-01-XX
**下次检查**: 每日检查点

**保持激情，持续构建！ <(￣︶￣)↗[GO!]** 